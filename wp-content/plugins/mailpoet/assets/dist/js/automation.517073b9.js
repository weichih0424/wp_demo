"use strict";(self.webpackChunkMailPoet3=self.webpackChunkMailPoet3||[]).push([[916],{66609:function(e,t,n){var a=n(45993),o=n.n(a),r=n(97846),l=n.n(r);const i=window.mailpoet_automation_api,d=`${i.root}/mailpoet/v1/automation`,c=(e,t)=>{const[n,o]=(0,a.useState)({data:void 0,loading:!1,error:void 0});return[(0,a.useCallback)((async n=>{var a;o((e=>({...e,loading:!0})));const r=await((e,t)=>fetch(`${d}/${e}`,t))(e,{...t,...n,headers:{"content-type":"application/json",...null!==(a=n?.headers)&&void 0!==a?a:{},"x-wp-nonce":i.nonce}});try{const e=await r.json(),t=r.ok?null:{...r,data:e};o((n=>({...n,data:e,error:t})))}catch(e){const t={response:r};o((e=>({...e,error:t})))}finally{o((e=>({...e,loading:!1})))}}),[t,e]),n]},s=e=>e.toString(16).padStart(2,"0"),u=()=>{if(!window.crypto||!window.crypto.getRandomValues)throw new Error("Web Crypto API 'crypto.getRandomValues' is not available");return Array.from(window.crypto.getRandomValues(new Uint8Array(8))).map(s).join("")},m=()=>{const e={id:u(),type:"action",key:"core:wait",args:{seconds:60}},t=(n=e.id,{id:u(),type:"trigger",key:"mailpoet:segment:subscribed",next_step_id:n});var n;return{name:`Test ${(new Date).toISOString()}`,steps:{[t.id]:t,[e.id]:e}}};function w(){var e;const[t,{loading:n,error:a}]=c("workflows",{method:"POST"});return o().createElement("div",null,o().createElement("button",{type:"button",onClick:()=>t({body:JSON.stringify(m())}),disabled:n},"Create testing workflow"),a&&o().createElement("div",null,null!==(e=a?.data?.message)&&void 0!==e?e:"An unknown error occurred"))}function p(){const{data:e,loading:t,error:n}=((e,t)=>{const[n,o]=c("workflows",void 0);return(0,a.useEffect)((()=>{n()}),[]),o})();return!e||t?o().createElement("div",null,"Calling API..."):o().createElement("div",null,n?"API error!":"API OK âœ“")}function v(){var e;const[t,{loading:n,error:a}]=c("system/database",{method:"POST"});return o().createElement("div",null,o().createElement("button",{type:"button",onClick:()=>t(),disabled:n},"Recreate DB schema (data will be lost)"),a&&o().createElement("div",null,null!==(e=a?.data?.message)&&void 0!==e?e:"An unknown error occurred"))}function g(){var e;const[t,{loading:n,error:a}]=c("system/database",{method:"DELETE"});return o().createElement("div",null,o().createElement("button",{type:"button",onClick:async()=>{await t(),window.location.href="/wp-admin/admin.php?page=mailpoet-experimental"},disabled:n},"Delete DB schema & deactivate feature"),a&&o().createElement("div",null,null!==(e=a?.data?.message)&&void 0!==e?e:"An unknown error occurred"))}function y(){return o().createElement("div",null,o().createElement(p,null),o().createElement(w,null),o().createElement(v,null),o().createElement(g,null))}window.addEventListener("DOMContentLoaded",(()=>{const e=document.getElementById("mailpoet_automation");e&&l().render(o().createElement(y,null),e)}))}},function(e){e.O(0,[351],(function(){return 66609,e(e.s=66609)})),e.O()}]);